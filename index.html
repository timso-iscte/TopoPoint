<!doctype html>
<html class="no-js" lang="">

<head>
    <meta charset="utf-8">
    <title></title>
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <meta property="og:title" content="">
    <meta property="og:type" content="">
    <meta property="og:url" content="">
    <meta property="og:image" content="">

    <link rel="manifest" href="site.webmanifest">
    <link rel="apple-touch-icon" href="icon.png">
    <!-- Place favicon.ico in the root directory -->

    <link rel="stylesheet" href="css/normalize.css">
    <link rel="stylesheet" href="css/main.css">

    <meta name="theme-color" content="#fafafa">
</head>

<body>

<!-- Add your site or application content here -->
<div class="container">
    <div class="row">
        <div class="column" style="float: left; width: 40%">
            <p>Input Altitude and latitude of starting point</p>
            <label for="lat1">Starting Altitude:</label>
            <input type="text" id="lat1" name="lat1"><br><br>
            <label for="lon1">Starting Latitude:</label>
            <input type="text" id="lon1" name="lon1"><br><br>
            <p>Input Altitude and latitude of end point</p>
            <label for="lat2">Ending Altitude:</label>
            <input type="text" id="lat2" name="lat2"><br><br>
            <label for="lon2">Ending Latitude:</label>
            <input type="text" id="lon2" name="lon2"><br><br>
            <p>Define the increment</p>
            <label for="step">increment:</label>
            <input type="text" id="step" name="step"><br><br>
            <button onclick = "Calculate()">Submit</button>
            </form>
        </div>


        <div class="column" style="float: left; width: 60%">
            <p>strings</p>
            <p id = "strings"></p>
        </div>
    </div>
</div>


<script>

    function Distance(lat1, lon1, lat2, lon2) {
        if ((lat1 == lat2) && (lon1 == lon2)) {
            return 0;
        }
        else {
            let radlat1 = Math.PI * lat1/180;
            let radlat2 = Math.PI * lat2/180;
            let theta = lon1-lon2;
            let radtheta = Math.PI * theta/180;
            let dist = Math.sin(radlat1) * Math.sin(radlat2) + Math.cos(radlat1) * Math.cos(radlat2) * Math.cos(radtheta);
            if (dist > 1) {
                dist = 1;
            }
            dist = Math.acos(dist);
            dist = dist * 180/Math.PI;
            dist = dist * 60 * 1.1515;
            dist = dist * 1.609344;
            return dist;
        }
    }
    function Calculate(){
        // alert("The function 'Calculate' is executed");
        // let lat1 = document.getElementById("lat1").value;
        // let lon1 = document.getElementById("lon1").value;
        // let lat2 = document.getElementById("lat2").value;
        // let lon2 = document.getElementById("lon2").value;
        // let step = document.getElementById("step").value;

//test parameters with dist = 10Km
        let lat1 = 38.77312066025468;
        let lon1 = -9.233858166510075;
        let lat2 = 38.85426159295318;
        let lon2 = -9.183768403982254;
        let step = 0.1;

        const distance = Distance(lat1, lon1, lat2, lon2);

        const lat_array = [];
        const lon_array = [];
        const inc_distance = [];

        const numberOfSteps = Math.floor((distance / step));

        const lat_step = Math.abs(lat1 - lat2) / numberOfSteps;
        const lon_step = Math.abs(lon1 - lon2) / numberOfSteps;


        for (let i = 0; i <= numberOfSteps; i++) {
            lat_array.push(parseFloat(lat1) + parseFloat((lat_step * i)));
            lon_array.push(parseFloat(lon1) + parseFloat((lon_step * i)));
            let inc_step = step * i;
            inc_distance.push(inc_step.toFixed(3));
        }
        GetAltitude(lat_array, lon_array, numberOfSteps, inc_distance);

    }


    async function GetAltitude(lat_array, lon_array, numberOfSteps, inc_distance){
        const url = 'https://api.opentopodata.org/v1/eudem25m?locations=';
        const elevation_array = [];
        for (let i = 0; i <= numberOfSteps; i++) {
            elevation_array.push(inc_distance[i] + " " + url + lat_array[i] + "," + lon_array[i]);
        }
        alert(elevation_array);
        document.getElementById('strings').innerText = elevation_array.join('\r\n');
    }



</script>

</body>

</html>
